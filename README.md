# pymerkletools
[![PyPI version](https://badge.fury.io/py/merkletools.svg)](https://badge.fury.io/py/merkletools)
[![Build Status](https://travis-ci.org/aliciawyy/pymerkletools.svg?branch=master)](https://travis-ci.org/aliciawyy/pymerkletools)
[![codecov](https://codecov.io/gh/aliciawyy/pymerkletools/branch/master/graph/badge.svg)](https://codecov.io/gh/aliciawyy/pymerkletools)

This project is adapted from the [pymerkletools](https://github.com/aliciawyy/pymerkletools) of Tierion.

It includes a `MerkleTree` class for creating Merkle trees, generating merkle proofs, and verification of merkle proofs.

## Installation

```
pip install pymerkletree
```

### Demo

The source code is simple by itself and examples can be found in the folder `demo`.

## Notes

### About tree generation

1. Internally, leaves are stored as `bytearray`. When the tree is built, it is generated by hashing together the `bytearray` values. 
2. Lonely leaf nodes are promoted to the next level up, as depicted below.

                         ROOT=Hash(H+E)
                         /        \
                        /          \
                 H=Hash(F+G)        E
                 /       \           \
                /         \           \
         F=Hash(A+B)    G=Hash(C+D)    E
          /     \        /     \        \
         /       \      /       \        \
        A         B    C         D        E


### Development
This module uses Python's `hashlib` for hashing. Inside a `MerkleTools` object all
hashes are stored as Python `bytearray`. This way hashes can be concatenated simply with `+` and the result
used as input for the hash function. But for
simplicity and easy to use `MerkleTools` methods expect that both input and outputs are hex
strings. We can convert from one type to the other using default Python string methods.
For example:
```python
hash = hashlib.sha256('a').digest()  # '\xca\x97\x81\x12\xca\x1b\xbd\xca\xfa\xc21\xb3\x9a#\xdcM\xa7\x86\xef\xf8\x14|Nr\xb9\x80w\x85\xaf\xeeH\xbb'
hex_string = hash.encode('hex')  # 'ca978112ca1bbdcafac231b39a23dc4da786eff8147c4e72b9807785afee48bb'
back_to_hash = hash_string.decode('hex')  # '\xca\x97\x81\x12\xca\x1b\xbd\xca\xfa\xc21\xb3\x9a#\xdcM\xa7\x86\xef\xf8\x14|Nr\xb9\x80w\x85\xaf\xeeH\xbb'
```
